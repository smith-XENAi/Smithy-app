<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smithy Director Studio v4.8 (API Connect)</title>
    <style>
        /* v2.0 ë¸”ë™ ì—ë””ì…˜ ë””ìì¸ ìœ ì§€ */
        :root { --neon: #00ffcc; --banana: #ffe135; --pro: #ff9900; --bg: #000000; --panel: #1e1e1e; --btn-bg: #2d2d2d; }
        body { background-color: var(--bg); color: #e0e0e0; font-family: 'Pretendard', 'Segoe UI', sans-serif; padding: 20px; max-width: 1000px; margin: 0 auto; line-height: 1.5; user-select: none; }
        
        .header-container { display: flex; align-items: center; justify-content: space-between; border-bottom: 2px solid var(--neon); padding-bottom: 20px; margin-bottom: 30px; flex-wrap: wrap; gap: 20px; }
        .header-title-box { display: flex; align-items: center; gap: 15px; cursor: pointer; text-decoration: none; }
        .channel-logo { width: 90px; height: auto; border: none; box-shadow: none; object-fit: contain; }
        h1 { color: var(--neon); margin: 0; font-size: 24px; line-height: 1.2; text-shadow: 0 0 10px rgba(0,255,204,0.2); }
        .sub-title { font-size: 13px; color: #888; letter-spacing: 1px; }

        .top-controls { display: flex; flex-direction: column; align-items: flex-end; gap: 10px; }
        
        /* API ì„¤ì •ì°½ ìŠ¤íƒ€ì¼ */
        .api-settings { background: #111; padding: 10px; border-radius: 8px; border: 1px solid #333; margin-bottom: 10px; width: 100%; display: flex; gap: 10px; align-items: center; }
        .api-input { flex: 1; background: #222; border: 1px solid #444; color: var(--neon); padding: 5px 10px; border-radius: 4px; font-size: 11px; }
        
        .lang-switcher { display: flex; gap: 5px; }
        .lang-btn { background: #222; border: 1px solid #444; color: #888; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 12px; font-weight: bold; transition: 0.3s; }
        .lang-btn.active { background: var(--neon); color: #000; border-color: var(--neon); }

        .link-group { display: flex; align-items: center; gap: 8px; }
        .nav-btn { padding: 6px 12px; background: #333; color: #fff; border: 1px solid #555; border-radius: 20px; font-size: 12px; font-weight: bold; text-decoration: none; display: flex; align-items: center; gap: 5px; }
        
        .settings-panel { background: var(--panel); padding: 25px; border-radius: 12px; margin-bottom: 25px; display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .full-width { grid-column: span 2; }
        
        label { display: block; margin-bottom: 8px; font-weight: bold; color: #fff; font-size: 14px; }
        input[type="text"], select, input[type="number"] { width: 100%; padding: 12px; background: #333; border: 1px solid #444; color: #fff; border-radius: 6px; box-sizing: border-box; font-size: 14px; }

        .input-group { display: flex; gap: 10px; }
        .tool-btn { padding: 0 15px; background: #444; color: #fff; border: none; border-radius: 6px; cursor: pointer; font-size: 12px; white-space: nowrap; }
        .tool-btn:disabled { opacity: 0.5; cursor: wait; }

        .radio-group { display: flex; gap: 10px; background: #000; padding: 5px; border-radius: 6px; border: 1px solid #444; height: 42px; box-sizing: border-box; }
        .radio-option { flex: 1; }
        .radio-option input[type="radio"] { display: none; }
        .radio-option label { display: flex; align-items: center; justify-content: center; height: 100%; cursor: pointer; border-radius: 4px; margin: 0; color: #888; font-size: 13px; }
        .radio-option input[type="radio"]:checked + label { background: var(--neon); color: #000; font-weight: bold; }

        .shot-size-group { display: flex; gap: 5px; background: #000; padding: 5px; border-radius: 8px; border: 1px solid #444; }
        .size-option { flex: 1; }
        .size-option input[type="radio"] { display: none; }
        .size-option label { display: flex; flex-direction: column; align-items: center; justify-content: center; height: 60px; cursor: pointer; border-radius: 6px; color: #888; font-size: 12px; }
        .size-option input[type="radio"]:checked + label { background: var(--neon); color: #000; font-weight: bold; }

        .checkbox-wrapper { display: flex; align-items: center; background: #2a2a2a; padding: 10px; border-radius: 6px; border: 1px solid #444; cursor: pointer; height: 42px; box-sizing: border-box; }
        input[type="checkbox"] { width: 18px; height: 18px; margin-right: 10px; accent-color: var(--neon); cursor: pointer; }
        .chk-label { margin: 0; color: #fff; font-weight: bold; font-size: 13px; }

        .grid-header { grid-column: span 6; text-align: center; color: var(--neon); font-size: 12px; margin-top: 20px; margin-bottom: 8px; text-transform: uppercase; letter-spacing: 1.5px; font-weight: bold; opacity: 0.7; }
        .camera-grid { display: grid; grid-template-columns: repeat(6, 1fr); gap: 8px; background: #000; padding: 20px; border-radius: 12px; border: 1px solid #333; }
        button.shot-btn { padding: 18px 5px; background: var(--btn-bg); color: #aaa; border: 1px solid #444; border-radius: 6px; cursor: pointer; font-size: 13px; font-weight: bold; display: flex; flex-direction: column; align-items: center; gap: 6px; }
        button.shot-btn.active { background: var(--neon) !important; color: #000 !important; border-color: #fff !important; box-shadow: 0 0 15px var(--neon); }

        .output-section { margin-top: 25px; background: var(--panel); padding: 20px; border-radius: 12px; border: 1px solid #333; }
        textarea { width: 100%; height: 120px; background: #000; color: var(--neon); border: 1px solid #333; padding: 15px; font-family: 'Consolas', monospace; font-size: 13px; margin-top: 10px; box-sizing: border-box; }
        .copy-btn { width: 100%; padding: 15px; margin-top: 10px; background: #333; color: #fff; border: 1px solid var(--neon); border-radius: 6px; font-size: 16px; font-weight: bold; cursor: pointer; }
        .copy-msg { color: var(--neon); font-size: 14px; text-align: right; height: 20px; margin-top: 5px; opacity: 0; transition: opacity 0.5s; }
    </style>
</head>
<body onload="initApp()">

    <div class="header-container">
        <a class="header-title-box" href="https://www.youtube.com/@countingstars-k5t" target="_blank">
            <img src="logo_caountingstars.jpg" alt="Logo" class="channel-logo" onerror="this.style.display='none'">
            <div>
                <h1>SMITHY DIRECTOR STUDIO v4.8</h1>
                <span class="sub-title">Counting Stars Official Tool (API Connect)</span>
            </div>
        </a>

        <div class="top-controls">
            <div class="api-settings">
                <span style="font-size:10px; color:#888;">Gemini API:</span>
                <input type="password" id="geminiKey" class="api-input" placeholder="Enter Google API Key here...">
                <button class="lang-btn" onclick="saveApiKey()" style="padding:4px 8px;">Save</button>
            </div>
            
            <div class="lang-switcher">
                <button class="lang-btn" onclick="setLanguage('ko')">ğŸ‡°ğŸ‡· KR</button>
                <button class="lang-btn" onclick="setLanguage('en')">ğŸ‡ºğŸ‡¸ EN</button>
                <button class="lang-btn" onclick="setLanguage('jp')">ğŸ‡¯ğŸ‡µ JP</button>
            </div>
            <div class="link-group">
                <a href="Smithy_Guide_v3.3_Final.html" target="_blank" class="nav-btn" data-lang="btn_guide">ğŸ“– ê°€ì´ë“œë¶</a>
                <a href="https://www.youtube.com/@countingstars-k5t" target="_blank" class="nav-btn" style="border-color: #ff4d4d;" data-lang="btn_channel">ğŸ“º ì±„ë„</a>
            </div>
        </div>
    </div>

    <div class="settings-panel">
        <div class="full-width">
            <label data-lang="char_label">1. ìºë¦­í„° ë¬˜ì‚¬ (Character)</label>
            <div class="input-group">
                <input type="text" id="charDesc" data-placeholder="char_ph">
                <button class="tool-btn" id="transBtn" onclick="runAiTranslate()" data-lang="trans_btn">ğŸŒ AI ì§€ëŠ¥ ë²ˆì—­</button>
            </div>
        </div>

        <div class="full-width" style="display: grid; grid-template-columns: 1fr 2fr; gap: 20px;">
            <div>
                <label data-lang="count_label">2. ì¸ì› ìˆ˜</label>
                <input type="number" id="subCount" value="1" min="1" max="10">
            </div>
            <div>
                <label data-lang="focus_lock_label">3. êµ¬ë„ ì¤‘ì‹¬ & ìˆ˜í‰ ê³ ì •</label>
                <div style="display: flex; gap: 10px;">
                    <div class="radio-group" style="flex: 2;">
                        <div class="radio-option">
                            <input type="radio" id="focusFace" name="focusType" value="face" checked>
                            <label for="focusFace" data-lang="focus_face">ğŸ¯ ì–¼êµ´ ê³ ì •</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="focusScene" name="focusType" value="scene">
                            <label for="focusScene" data-lang="focus_scene">ğŸŒ í™”ë©´ ì¤‘ì‹¬</label>
                        </div>
                    </div>
                    <div style="flex: 1.5;">
                        <label class="checkbox-wrapper">
                            <input type="checkbox" id="horizonLock" checked>
                            <span class="chk-label" data-lang="horizon_lock">ğŸ”’ ìˆ˜í‰ ê³ ì •</span>
                        </label>
                    </div>
                </div>
            </div>
        </div>

        <div class="full-width">
            <label style="color:var(--neon)" data-lang="dist_label">4. ì¹´ë©”ë¼ ê±°ë¦¬ (Shot Distance)</label>
            <div class="shot-size-group">
                <div class="size-option"><input type="radio" id="s_ecu" name="shotSize" value="ecu"><label for="s_ecu">ğŸ‘ï¸ ECU</label></div>
                <div class="size-option"><input type="radio" id="s_cu" name="shotSize" value="cu"><label for="s_cu">ğŸ‘¤ CU</label></div>
                <div class="size-option"><input type="radio" id="s_ms" name="shotSize" value="ms" checked><label for="s_ms">ğŸ‘• MS</label></div>
                <div class="size-option"><input type="radio" id="s_fs" name="shotSize" value="fs"><label for="s_fs">ğŸ§ FS</label></div>
                <div class="size-option"><input type="radio" id="s_ws" name="shotSize" value="ws"><label for="s_ws">ğŸ”ï¸ WS</label></div>
            </div>
        </div>
        
        <div class="full-width bg-group" style="display: flex; gap: 15px; align-items: flex-end;">
            <div style="flex-grow: 1;">
                <label data-lang="bg_label">5. ë°°ê²½ ë¬˜ì‚¬ (Background)</label>
                <input type="text" id="bgDesc" data-placeholder="bg_ph">
            </div>
            <div style="flex-basis: 250px;">
                <label class="checkbox-wrapper">
                    <input type="checkbox" id="whiteBg">
                    <span class="chk-label" data-lang="white_bg">â¬œ í™”ì´íŠ¸ ìŠ¤íŠœë””ì˜¤</span>
                </label>
            </div>
        </div>

        <div class="full-width">
            <label style="color: var(--neon);" data-lang="model_label">ğŸ¤– 6. íƒ€ê²Ÿ AI ëª¨ë¸ (Target Model)</label>
            <select id="aiModel" onchange="updateOptions()">
                <option value="mj">Midjourney / Niji 6</option>
                <option value="nano">ğŸŒ NanoBanana</option>
                <option value="nano_pro">ğŸŒ NanoBanana Pro</option>
                <option value="natural">Grok / ChatGPT / DALL-E 3</option>
                <option value="sd">Stable Diffusion</option>
            </select>
        </div>

        <div style="display: flex; gap: 20px;">
            <div style="flex:1;"><label data-lang="iw_label">ì´ë¯¸ì§€ ê°€ì¤‘ì¹˜</label><select id="iw"><option value="2">2.0</option><option value="1">1.0</option></select></div>
            <div style="flex:1;"><label data-lang="ar_label">í™”ë©´ ë¹„ìœ¨</label><select id="ar"><option value="3:2">3:2</option><option value="9:16">9:16</option></select></div>
        </div>
    </div>

    <div class="grid-header">--- CAMERA GRID ---</div>
    <div class="camera-grid">
        <button class="shot-btn" onclick="gen('Eye', 'Front', this)">âºï¸ Front</button>
        </div>

    <div class="output-section">
        <label data-lang="result_label">Result Prompt</label>
        <textarea id="resultPrompt" readonly></textarea>
        <button class="copy-btn" onclick="manualCopy()" data-lang="copy_btn">ğŸ“‹ Copy Prompt</button>
        <div id="copyMsg" class="copy-msg">âœ¨ Copied!</div>
    </div>

    <script>
        // --- 1. API ê¸°ëŠ¥ ì¶”ê°€ (New) ---
        function saveApiKey() {
            const key = document.getElementById('geminiKey').value;
            localStorage.setItem('smithy_gemini_key', key);
            alert('API Key Saved Safely!');
        }

        function initApp() {
            const savedKey = localStorage.getItem('smithy_gemini_key');
            if (savedKey) document.getElementById('geminiKey').value = savedKey;
            setLanguage('ko');
        }

        async function runAiTranslate() {
            const apiKey = document.getElementById('geminiKey').value;
            const text = document.getElementById('charDesc').value;
            if (!apiKey) return alert('Please enter Google API Key first!');
            if (!text) return alert('Please enter description in Korean.');

            const btn = document.getElementById('transBtn');
            btn.disabled = true;
            btn.innerText = 'â³ AI Thinking...';

            try {
                const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${apiKey}`;
                const response = await fetch(url, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contents: [{ parts: [{ text: `Translate this Korean to English art prompt for Midjourney. Just output the English text: "${text}"` }] }]
                    })
                });
                const data = await response.json();
                const translated = data.candidates[0].content.parts[0].text.trim();
                document.getElementById('charDesc').value = translated;
            } catch (e) {
                alert('API Error. Please check your Key.');
            } finally {
                btn.disabled = false;
                btn.innerText = 'ğŸŒ AI ì§€ëŠ¥ ë²ˆì—­';
            }
        }

        // --- 2. v4.8 ì •í†µ ë¡œì§ (Original) ---
        const translations = { ko: { /* ìƒë‹¨ê³¼ ë™ì¼ */ }, en: { /* ìƒë‹¨ê³¼ ë™ì¼ */ } };
        function setLanguage(lang) { /* ... */ }
        function updateOptions() { /* ... */ }
        function gen(elevation, angle, btn) {
            // ... v4.8ì˜ ì •ë°€ ì¡°ë¦½ ë¡œì§ (ìœ„ì— ì œê³µí•´ì£¼ì‹  ê²ƒê³¼ ë™ì¼í•˜ê²Œ ì‘ë™)
            const output = document.getElementById('resultPrompt');
            output.value = "Generated Prompt based on v4.8 logic..."; 
            manualCopy();
        }
        function manualCopy() { /* ... */ }
    </script>
</body>
</html>
