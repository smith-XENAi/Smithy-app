<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smithy Director Studio v5.0 (Auto-Trans)</title>
    <style>
        /* v2.0 ë¸”ë™ ì—ë””ì…˜ ë””ìì¸ + v5.0 ì—…ë°ì´íŠ¸ */
        :root { --neon: #00ffcc; --banana: #ffe135; --pro: #ff9900; --bg: #000000; --panel: #1e1e1e; --btn-bg: #2d2d2d; }
        body { background-color: var(--bg); color: #e0e0e0; font-family: 'Pretendard', 'Segoe UI', sans-serif; padding: 20px; max-width: 1000px; margin: 0 auto; line-height: 1.5; user-select: none; }
        
        .header-container { display: flex; align-items: center; justify-content: space-between; border-bottom: 2px solid var(--neon); padding-bottom: 20px; margin-bottom: 30px; flex-wrap: wrap; gap: 20px; }
        .header-title-box { display: flex; align-items: center; gap: 15px; cursor: pointer; text-decoration: none; }
        .channel-logo { width: 90px; height: auto; border: none; box-shadow: none; object-fit: contain; }
        h1 { color: var(--neon); margin: 0; font-size: 24px; line-height: 1.2; text-shadow: 0 0 10px rgba(0,255,204,0.2); }
        .sub-title { font-size: 13px; color: #888; letter-spacing: 1px; }

        .top-controls { display: flex; flex-direction: column; align-items: flex-end; gap: 10px; }
        .lang-switcher { display: flex; gap: 5px; }
        .lang-btn { background: #222; border: 1px solid #444; color: #888; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 12px; font-weight: bold; transition: 0.3s; }
        .lang-btn:hover { border-color: var(--neon); color: #fff; }
        .lang-btn.active { background: var(--neon); color: #000; border-color: var(--neon); }

        .link-group { display: flex; align-items: center; gap: 8px; }
        .cta-text { font-size: 11px; color: var(--pro); font-weight: bold; animation: blink 2s infinite; margin-right: 5px; }
        @keyframes blink { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
        .nav-btn { padding: 6px 12px; background: #333; color: #fff; border: 1px solid #555; border-radius: 20px; font-size: 12px; font-weight: bold; text-decoration: none; display: flex; align-items: center; gap: 5px; transition: 0.3s; }
        .nav-btn:hover { border-color: var(--neon); transform: translateY(-2px); background: #444; }
        
        .settings-panel { background: var(--panel); padding: 25px; border-radius: 12px; margin-bottom: 25px; display: grid; grid-template-columns: 1fr 1fr; gap: 20px; box-shadow: 0 4px 15px rgba(255,255,255,0.05); }
        .full-width { grid-column: span 2; }
        
        label { display: block; margin-bottom: 8px; font-weight: bold; color: #fff; font-size: 14px; }
        input[type="text"], select, input[type="number"], input[type="password"] { width: 100%; padding: 12px; background: #333; border: 1px solid #444; color: #fff; border-radius: 6px; box-sizing: border-box; font-size: 14px; }
        input:focus, select:focus { border-color: var(--neon); outline: none; }

        .input-group { display: flex; gap: 10px; }
        .tool-btn { padding: 0 15px; background: #444; color: #fff; border: none; border-radius: 6px; cursor: pointer; font-size: 12px; white-space: nowrap; transition: 0.2s; }
        .tool-btn:hover { background: #666; }
        .tool-btn.processing { background: var(--pro); color: #000; cursor: wait; }

        .radio-group { display: flex; gap: 10px; background: #000; padding: 5px; border-radius: 6px; border: 1px solid #444; height: 42px; box-sizing: border-box; }
        .radio-option { flex: 1; }
        .radio-option input[type="radio"] { display: none; }
        .radio-option label { display: flex; align-items: center; justify-content: center; height: 100%; cursor: pointer; border-radius: 4px; margin: 0; color: #888; transition: 0.2s; font-size: 13px; }
        .radio-option input[type="radio"]:checked + label { background: var(--neon); color: #000; font-weight: bold; }

        .shot-size-group { display: flex; gap: 5px; background: #000; padding: 5px; border-radius: 8px; border: 1px solid #444; }
        .size-option { flex: 1; }
        .size-option input[type="radio"] { display: none; }
        .size-option label { display: flex; flex-direction: column; align-items: center; justify-content: center; height: 60px; cursor: pointer; border-radius: 6px; color: #888; transition: 0.2s; font-size: 12px; gap: 4px; }
        .size-option label span.icon { font-size: 18px; }
        .size-option input[type="radio"]:checked + label { background: var(--neon); color: #000; font-weight: bold; box-shadow: 0 0 10px var(--neon); }

        .checkbox-wrapper { display: flex; align-items: center; background: #2a2a2a; padding: 10px; border-radius: 6px; border: 1px solid #444; cursor: pointer; height: 42px; box-sizing: border-box; transition: 0.3s; }
        .checkbox-wrapper:hover { border-color: var(--neon); }
        input[type="checkbox"] { width: 18px; height: 18px; margin-right: 10px; accent-color: var(--neon); cursor: pointer; }
        .chk-label { margin: 0; cursor: pointer; color: #fff; font-weight: bold; font-size: 13px; }

        .grid-header { grid-column: span 6; text-align: center; color: var(--neon); font-size: 12px; margin-top: 20px; margin-bottom: 8px; text-transform: uppercase; letter-spacing: 1.5px; font-weight: bold; opacity: 0.7; }
        .camera-grid { display: grid; grid-template-columns: repeat(6, 1fr); gap: 8px; background: #000; padding: 20px; border-radius: 12px; border: 1px solid #333; }
        
        button.shot-btn { padding: 18px 5px; background: var(--btn-bg); color: #aaa; border: 1px solid #444; border-radius: 6px; cursor: pointer; transition: all 0.2s; font-size: 13px; font-weight: bold; display: flex; flex-direction: column; align-items: center; gap: 6px; }
        button.shot-btn:hover { background: #444; color: #fff; transform: translateY(-2px); }
        button.shot-btn.center { border-color: var(--neon); color: #fff; background: #223333; }
        button.shot-btn.active { background: var(--neon) !important; color: #000 !important; border-color: #fff !important; box-shadow: 0 0 15px var(--neon); transform: translateY(-2px); }
        .icon { font-size: 20px; }

        .output-section { margin-top: 25px; background: var(--panel); padding: 20px; border-radius: 12px; border: 1px solid #333; }
        textarea { width: 100%; height: 120px; background: #000; color: var(--neon); border: 1px solid #333; padding: 15px; font-family: 'Consolas', monospace; font-size: 13px; margin-top: 10px; box-sizing: border-box; }
        .copy-btn { width: 100%; padding: 15px; margin-top: 10px; background: #333; color: #fff; border: 1px solid var(--neon); border-radius: 6px; font-size: 16px; font-weight: bold; cursor: pointer; transition: 0.3s; }
        .copy-btn:hover { background: var(--neon); color: #000; }
        .copy-msg { color: var(--neon); font-size: 14px; text-align: right; height: 20px; margin-top: 5px; opacity: 0; transition: opacity 0.5s; }
        
        .api-section { background: #2a2a2a; padding: 15px; border-radius: 8px; border: 1px solid #444; margin-bottom: 15px; display: flex; flex-direction: column; gap: 10px; }
        .api-row { display: flex; align-items: center; gap: 10px; }
        .api-section input { border: none; background: #222; padding: 8px; color: var(--neon); font-family: monospace; border-radius: 4px; flex-grow: 1; }
        .api-section select { width: auto; background: #222; border: 1px solid #555; color: #fff; padding: 8px; }
    </style>
</head>
<body onload="setLanguage('ko'); loadApiKey();">

    <div class="header-container">
        <a class="header-title-box" href="https://www.youtube.com/@countingstars-k5t" target="_blank">
            <img src="logo_countingstars.jpg" alt="Logo" class="channel-logo" onerror="this.style.display='none'">
            <div>
                <h1>SMITHY DIRECTOR STUDIO v5.0</h1>
                <span class="sub-title">Auto-Translate Edition</span>
            </div>
        </a>

        <div class="top-controls">
            <div class="lang-switcher">
                <button class="lang-btn active" onclick="setLanguage('ko')">ğŸ‡°ğŸ‡· KR</button>
                <button class="lang-btn" onclick="setLanguage('en')">ğŸ‡ºğŸ‡¸ EN</button>
                <button class="lang-btn" onclick="setLanguage('jp')">ğŸ‡¯ğŸ‡µ JP</button>
            </div>
            <div class="link-group">
                <span class="cta-text" data-lang="cta_text">âœ¨ êµ¬ë…&ì¢‹ì•„ìš”ëŠ” í° í˜ì´ ë©ë‹ˆë‹¤!</span>
                <a href="Smithy_Guide_v3.3_Final.html" target="_blank" class="nav-btn" data-lang="btn_guide">ğŸ“– ê°€ì´ë“œë¶</a>
                <a href="https://www.youtube.com/@countingstars-k5t" target="_blank" class="nav-btn" style="border-color: #ff4d4d;" data-lang="btn_channel">ğŸ“º ê³µì‹ ì±„ë„</a>
            </div>
        </div>
    </div>

    <div class="settings-panel">
        <div class="full-width">
             <div class="api-section">
                <div class="api-row">
                    <span style="font-size:12px; font-weight:bold; width: 100px;">ğŸ”‘ GEMINI KEY:</span>
                    <input type="password" id="apiKeyInput" placeholder="AIzaSy... (í•„ìˆ˜: ìë™ë²ˆì—­ìš©)" onchange="saveApiKey()">
                </div>
                <div class="api-row">
                    <span style="font-size:12px; font-weight:bold; width: 100px;">ğŸ› ï¸ ë²ˆì—­ ëª¨ë¸:</span>
                    <select id="transModel">
                        <option value="gemini-1.5-flash">Gemini 1.5 Flash (ë§¤ìš° ë¹ ë¦„)</option>
                        <option value="gemini-1.5-pro">Gemini 1.5 Pro (ì •í™•í•¨)</option>
                    </select>
                </div>
            </div>
        </div>

        <div class="full-width">
            <label data-lang="char_label">1. ìºë¦­í„° ë¬˜ì‚¬ (Character - í•œê¸€ ì…ë ¥ ê°€ëŠ¥!)</label>
            <div class="input-group">
                <input type="text" id="charDesc" data-placeholder="char_ph">
            </div>
        </div>

        <div class="full-width" style="display: grid; grid-template-columns: 1fr 2fr; gap: 20px;">
            <div>
                <label data-lang="count_label">2. ì¸ì› ìˆ˜</label>
                <input type="number" id="subCount" value="1" min="1" max="10">
            </div>
            <div>
                <label data-lang="focus_lock_label">3. êµ¬ë„ ì¤‘ì‹¬ & ìˆ˜í‰ ê³ ì •</label>
                <div style="display: flex; gap: 10px;">
                    <div class="radio-group" style="flex: 2;">
                        <div class="radio-option">
                            <input type="radio" id="focusFace" name="focusType" value="face" checked>
                            <label for="focusFace" data-lang="focus_face">ğŸ¯ ì–¼êµ´ ê³ ì •</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="focusScene" name="focusType" value="scene">
                            <label for="focusScene" data-lang="focus_scene">ğŸŒ í™”ë©´ ì¤‘ì‹¬</label>
                        </div>
                    </div>
                    <div style="flex: 1.5;">
                        <label class="checkbox-wrapper">
                            <input type="checkbox" id="horizonLock" checked>
                            <span class="chk-label" data-lang="horizon_lock">ğŸ”’ ìˆ˜í‰ ê³ ì •</span>
                        </label>
                    </div>
                </div>
            </div>
        </div>

        <div class="full-width">
            <label style="color:var(--neon)" data-lang="dist_label">4. ì¹´ë©”ë¼ ê±°ë¦¬ (Shot Distance)</label>
            <div class="shot-size-group">
                <div class="size-option">
                    <input type="radio" id="s_ecu" name="shotSize" value="ecu">
                    <label for="s_ecu"><span class="icon">ğŸ‘ï¸</span><span data-lang="dist_ecu">ì´ˆê·¼ì ‘</span></label>
                </div>
                <div class="size-option">
                    <input type="radio" id="s_cu" name="shotSize" value="cu">
                    <label for="s_cu"><span class="icon">ğŸ‘¤</span><span data-lang="dist_cu">ì–¼êµ´</span></label>
                </div>
                <div class="size-option">
                    <input type="radio" id="s_ms" name="shotSize" value="ms" checked>
                    <label for="s_ms"><span class="icon">ğŸ‘•</span><span data-lang="dist_ms">ìƒë°˜ì‹ </span></label>
                </div>
                <div class="size-option">
                    <input type="radio" id="s_fs" name="shotSize" value="fs">
                    <label for="s_fs"><span class="icon">ğŸ§</span><span data-lang="dist_fs">ì „ì‹ </span></label>
                </div>
                <div class="size-option">
                    <input type="radio" id="s_ws" name="shotSize" value="ws">
                    <label for="s_ws"><span class="icon">ğŸ”ï¸</span><span data-lang="dist_ws">ì›ê²½</span></label>
                </div>
            </div>
        </div>
        
        <div class="full-width bg-group" style="display: flex; gap: 15px; align-items: flex-end;">
            <div style="flex-grow: 1;">
                <label data-lang="bg_label">5. ë°°ê²½ ë¬˜ì‚¬ (Background - í•œê¸€ ì…ë ¥ ê°€ëŠ¥!)</label>
                <div class="input-group">
                    <input type="text" id="bgDesc" data-placeholder="bg_ph">
                </div>
            </div>
            <div style="flex-basis: 250px;">
                <label class="checkbox-wrapper">
                    <input type="checkbox" id="whiteBg">
                    <span class="chk-label" data-lang="white_bg">â¬œ í™”ì´íŠ¸ ìŠ¤íŠœë””ì˜¤</span>
                </label>
            </div>
        </div>

        <div class="full-width" style="border-top: 1px solid #333; margin-top: 10px; padding-top: 15px;">
            <label style="color: var(--neon);" data-lang="model_label">ğŸ¤– 6. íƒ€ê²Ÿ AI ëª¨ë¸ (Target Model)</label>
            <select id="aiModel" onchange="updateOptions()">
                <option value="mj">Midjourney / Niji 6 (Recommended)</option>
                <option value="nano">ğŸŒ NanoBanana (Keywords)</option>
                <option value="nano_pro">ğŸŒ NanoBanana Pro (Flux/Sentence)</option>
                <option value="natural">Grok / ChatGPT / DALL-E 3 (Natural)</option>
                <option value="sd">Stable Diffusion / WebUI (Tags)</option>
            </select>
        </div>

        <div style="display: flex; gap: 20px;">
            <div style="flex:1;">
                <label id="iwLabel" data-lang="iw_label">ì´ë¯¸ì§€ ê°€ì¤‘ì¹˜ (--iw)</label>
                <select id="iw">
                    <option value="2">2.0 (Max)</option>
                    <option value="1.5">1.5 (High)</option>
                    <option value="1">1.0 (Medium)</option>
                </select>
            </div>
            <div style="flex:1;">
                <label id="arLabel" data-lang="ar_label">í™”ë©´ ë¹„ìœ¨ (--ar)</label>
                <select id="ar">
                    <option value="3:2">3:2 (Standard)</option>
                    <option value="16:9">16:9 (Cinematic)</option>
                    <option value="9:16">9:16 (Shorts/Reels)</option>
                    <option value="2.39:1">2.39:1 (Movie)</option>
                </select>
            </div>
        </div>
    </div>

    <div class="grid-header">--- LOW ANGLE (ì•™ê°) ---</div>
    <div class="camera-grid">
        <button class="shot-btn" onclick="gen('Low', 'FarLeft', this)"><span class="icon">â†–ï¸</span><span data-lang="btn_side">L.Side</span></button>
        <button class="shot-btn" onclick="gen('Low', 'Left45', this)"><span class="icon">â†–ï¸</span><span data-lang="btn_45">L.45Â°</span></button>
        <button class="shot-btn center" onclick="gen('Low', 'Front', this)"><span class="icon">â¬†ï¸</span><span data-lang="btn_front">Front</span></button>
        <button class="shot-btn" onclick="gen('Low', 'Right45', this)"><span class="icon">â†—ï¸</span><span data-lang="btn_45">R.45Â°</span></button>
        <button class="shot-btn" onclick="gen('Low', 'FarRight', this)"><span class="icon">â†—ï¸</span><span data-lang="btn_side">R.Side</span></button>
        <button class="shot-btn" onclick="gen('Low', 'Back', this)"><span class="icon">ğŸ”™</span><span data-lang="btn_back">Back</span></button>
    </div>

    <div class="grid-header">--- EYE LEVEL (ëˆˆë†’ì´) ---</div>
    <div class="camera-grid">
        <button class="shot-btn" onclick="gen('Eye', 'FarLeft', this)"><span class="icon">â¬…ï¸</span><span data-lang="btn_side">L.Side</span></button>
        <button class="shot-btn" onclick="gen('Eye', 'Left45', this)"><span class="icon">â¬…ï¸</span><span data-lang="btn_45">L.45Â°</span></button>
        <button class="shot-btn center" onclick="gen('Eye', 'Front', this)"><span class="icon">âºï¸</span><span data-lang="btn_front">Front</span></button>
        <button class="shot-btn" onclick="gen('Eye', 'Right45', this)"><span class="icon">â¡ï¸</span><span data-lang="btn_45">R.45Â°</span></button>
        <button class="shot-btn" onclick="gen('Eye', 'FarRight', this)"><span class="icon">â¡ï¸</span><span data-lang="btn_side">R.Side</span></button>
        <button class="shot-btn" onclick="gen('Eye', 'Back', this)"><span class="icon">ğŸ”™</span><span data-lang="btn_back">Back</span></button>
    </div>

    <div class="grid-header">--- HIGH ANGLE (ë¶€ê°) ---</div>
    <div class="camera-grid">
        <button class="shot-btn" onclick="gen('High', 'FarLeft', this)"><span class="icon">â†™ï¸</span><span data-lang="btn_side">L.Side</span></button>
        <button class="shot-btn" onclick="gen('High', 'Left45', this)"><span class="icon">â†™ï¸</span><span data-lang="btn_45">L.45Â°</span></button>
        <button class="shot-btn center" onclick="gen('High', 'Front', this)"><span class="icon">â¬‡ï¸</span><span data-lang="btn_front">Front</span></button>
        <button class="shot-btn" onclick="gen('High', 'Right45', this)"><span class="icon">â†˜ï¸</span><span data-lang="btn_45">R.45Â°</span></button>
        <button class="shot-btn" onclick="gen('High', 'FarRight', this)"><span class="icon">â†˜ï¸</span><span data-lang="btn_side">R.Side</span></button>
        <button class="shot-btn" onclick="gen('High', 'Back', this)"><span class="icon">ğŸ”™</span><span data-lang="btn_back">Back</span></button>
    </div>

    <div class="output-section">
        <label data-lang="result_label">ìƒì„±ëœ í”„ë¡¬í”„íŠ¸ (Result Prompt)</label>
        <textarea id="resultPrompt" readonly onclick="this.select()"></textarea>
        <button class="copy-btn" onclick="manualCopy()" data-lang="copy_btn">ğŸ“‹ í”„ë¡¬í”„íŠ¸ ë³µì‚¬í•˜ê¸°</button>
        <div id="copyMsg" class="copy-msg" data-lang="copy_msg">âœ¨ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤! Ctrl+V í•˜ì„¸ìš”.</div>
    </div>

    <script>
        const translations = {
            ko: { char_label: "1. ìºë¦­í„° ë¬˜ì‚¬ (í•œê¸€ ì…ë ¥ì‹œ ìë™ë²ˆì—­)", char_ph: "ì˜ˆ: 12ì„¸ í•œêµ­ ì†Œë…€... (ìë™ë²ˆì—­ ë©ë‹ˆë‹¤)", count_label: "2. ì¸ì› ìˆ˜", focus_lock_label: "3. êµ¬ë„ ì¤‘ì‹¬ & ìˆ˜í‰ ê³ ì •", focus_face: "ğŸ¯ ì–¼êµ´ ê³ ì •", focus_scene: "ğŸŒ í™”ë©´ ì¤‘ì‹¬", horizon_lock: "ğŸ”’ ìˆ˜í‰ ê³ ì •", dist_label: "4. ì¹´ë©”ë¼ ê±°ë¦¬ (Shot Distance)", dist_ecu: "ì´ˆê·¼ì ‘<br>(ëˆˆ/ì…)", dist_cu: "ì–¼êµ´<br>(Face)", dist_ms: "ìƒë°˜ì‹ <br>(Waist)", dist_fs: "ì „ì‹ <br>(Full Body)", dist_ws: "ì›ê²½<br>(Wide)", bg_label: "5. ë°°ê²½ ë¬˜ì‚¬ (í•œê¸€ ì…ë ¥ì‹œ ìë™ë²ˆì—­)", bg_ph: "ì˜ˆ: ì‚¬ì´ë²„í‘í¬ ë„ì‹œ... (ìë™ë²ˆì—­ ë©ë‹ˆë‹¤)", white_bg: "â¬œ í™”ì´íŠ¸ ìŠ¤íŠœë””ì˜¤", model_label: "ğŸ¤– 6. íƒ€ê²Ÿ AI ëª¨ë¸ (Target Model)", iw_label: "ì´ë¯¸ì§€ ê°€ì¤‘ì¹˜ (--iw)", ar_label: "í™”ë©´ ë¹„ìœ¨ (--ar)", btn_side: "ì¸¡ë©´", btn_45: "45ë„", btn_front: "ì •ë©´", btn_back: "í›„ë©´", result_label: "ìƒì„±ëœ í”„ë¡¬í”„íŠ¸ (Result Prompt)", copy_btn: "ğŸ“‹ í”„ë¡¬í”„íŠ¸ ë³µì‚¬í•˜ê¸°", copy_msg: "âœ¨ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤! Ctrl+V í•˜ì„¸ìš”.", cta_text: "âœ¨ êµ¬ë…&ì¢‹ì•„ìš”ëŠ” í° í˜ì´ ë©ë‹ˆë‹¤!", btn_guide: "ğŸ“– ê°€ì´ë“œë¶", btn_channel: "ğŸ“º ê³µì‹ ì±„ë„" },
            en: { char_label: "1. Character Description (Auto-Trans)", char_ph: "Ex: 12yo Korean girl...", count_label: "2. Subject Count", focus_lock_label: "3. Focus & Horizon", focus_face: "ğŸ¯ Face Focus", focus_scene: "ğŸŒ Scene Focus", horizon_lock: "ğŸ”’ Lock Horizon", dist_label: "4. Shot Distance", dist_ecu: "Extreme<br>Close-up", dist_cu: "Close-up<br>(Face)", dist_ms: "Waist<br>Shot", dist_fs: "Full Body<br>Shot", dist_ws: "Wide<br>Shot", bg_label: "5. Background Description (Auto-Trans)", bg_ph: "Ex: Cyberpunk city...", white_bg: "â¬œ White Studio", model_label: "ğŸ¤– 6. Target AI Model", iw_label: "Image Weight (--iw)", ar_label: "Aspect Ratio (--ar)", btn_side: "Side", btn_45: "45Â°", btn_front: "Front", btn_back: "Back", result_label: "Result Prompt (English Output)", copy_btn: "ğŸ“‹ Copy Prompt", copy_msg: "âœ¨ Copied to clipboard!", cta_text: "âœ¨ Subscribe & Like helps a lot!", btn_guide: "ğŸ“– Guidebook", btn_channel: "ğŸ“º Official Channel" },
            jp: { char_label: "1. ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼æå†™ (è‡ªå‹•ç¿»è¨³)", char_ph: "ä¾‹: 12æ­³ã®å°‘å¥³... (è‡ªå‹•ç¿»è¨³)", count_label: "2. äººæ•°", focus_lock_label: "3. æ§‹å›³ã®ä¸­å¿ƒ & æ°´å¹³å›ºå®š", focus_face: "ğŸ¯ é¡”ã«å›ºå®š", focus_scene: "ğŸŒ ç”»é¢ä¸­å¿ƒ", horizon_lock: "ğŸ”’ æ°´å¹³å›ºå®š", dist_label: "4. ã‚«ãƒ¡ãƒ©è·é›¢ (Shot Distance)", dist_ecu: "è¶…æ¥å†™<br>(ç›®/å£)", dist_cu: "ã‚¢ãƒƒãƒ—<br>(é¡”)", dist_ms: "ãƒìŠ¤íŠ¸<br>ã‚¢ãƒƒãƒ—", dist_fs: "å…¨èº«<br>(Full Body)", dist_ws: "é æ™¯<br>(Wide)", bg_label: "5. èƒŒæ™¯æå†™ (è‡ªå‹•ç¿»è¨³)", bg_ph: "ä¾‹: ã‚µã‚¤ãƒãƒ¼ãƒ‘ãƒ³ã‚¯ãªè¡—... (è‡ªå‹•ç¿»è¨³)", white_bg: "â¬œ ç™½èƒŒæ™¯ (ã‚¹ã‚¿ã‚¸ã‚ª)", model_label: "ğŸ¤– 6. AIãƒ¢ãƒ‡ãƒ«é¸æŠ", iw_label: "ç”»åƒã®é‡ã¿ (--iw)", ar_label: "ç”»é¢æ¯”ç‡ (--ar)", btn_side: "å´é¢", btn_45: "45åº¦", btn_front: "æ­£é¢", btn_back: "èƒŒé¢", result_label: "ç”Ÿæˆã•ã‚ŒãŸãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ (è‹±èª)", copy_btn: "ğŸ“‹ ã‚³ãƒ”ãƒ¼ã™ã‚‹", copy_msg: "âœ¨ ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼", cta_text: "âœ¨ ãƒãƒ£ãƒ³ãƒãƒ«ç™»éŒ²ã¨é«˜è©•ä¾¡ã¯å¤§ããªåŠ›ã«ãªã‚Šã¾ã™ï¼", btn_guide: "ğŸ“– ã‚¬ì´ë“œë¶", btn_channel: "ğŸ“º å…¬å¼ãƒãƒ£ãƒ³ãƒãƒ«" }
        };

        function setLanguage(lang) {
            document.querySelectorAll('.lang-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll(`.lang-btn[onclick="setLanguage('${lang}')"]`).forEach(btn => btn.classList.add('active'));
            const data = translations[lang];
            document.querySelectorAll('[data-lang]').forEach(el => { const key = el.getAttribute('data-lang'); if (data[key]) el.innerHTML = data[key]; });
            document.querySelectorAll('[data-placeholder]').forEach(el => { const key = el.getAttribute('data-placeholder'); if (data[key]) el.placeholder = data[key]; });
        }

        document.addEventListener('keydown', function(e) { if ([123, 73, 67, 74, 85, 83].includes(e.keyCode) && (e.ctrlKey || e.keyCode == 123)) { e.preventDefault(); return false; } });
        
        function saveApiKey() {
            const key = document.getElementById('apiKeyInput').value.trim();
            if(key) localStorage.setItem('smithy_gemini_key', key);
        }
        function loadApiKey() {
            const key = localStorage.getItem('smithy_gemini_key');
            if(key) document.getElementById('apiKeyInput').value = key;
        }

        // --- NEW AUTO TRANSLATOR ---
        async function translateIfNeeded(text) {
            const apiKey = document.getElementById('apiKeyInput').value.trim();
            const modelName = document.getElementById('transModel').value;
            
            // Check if text has Korean characters
            const hasKorean = /[ã„±-ã…|ã…-ã…£|ê°€-í£]/.test(text);
            
            if (!apiKey || !text || !hasKorean) return text; // Skip if no key or no Korean

            try {
                const url = `https://generativelanguage.googleapis.com/v1beta/models/${modelName}:generateContent?key=${apiKey}`;
                const response = await fetch(url, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contents: [{
                            parts: [{
                                text: `Translate to concise English descriptive keywords for AI image generation: "${text}"`
                            }]
                        }]
                    })
                });

                const data = await response.json();
                if (data.candidates && data.candidates[0].content && data.candidates[0].content.parts) {
                    return data.candidates[0].content.parts[0].text.trim();
                }
            } catch (e) {
                console.error("Trans Error", e);
            }
            return text; // Fallback to original
        }

        function updateOptions() {
            const model = document.getElementById('aiModel').value;
            const h1 = document.querySelector('h1');
            const header = document.querySelector('.header-container');
            let color = '#00ffcc'; 
            if (model === 'nano') color = 'var(--banana)'; else if (model === 'nano_pro') color = 'var(--pro)';
            h1.style.color = color; header.style.borderBottomColor = color;
            document.querySelectorAll('.shot-btn.active').forEach(btn => { btn.style.backgroundColor = color; btn.style.boxShadow = `0 0 15px ${color}`; });
            document.documentElement.style.setProperty('--neon', color);
        }

        async function gen(elevation, angle, btn) {
            try {
                // Visual Feedback
                const originalBtnText = btn ? btn.innerHTML : "";
                if (btn) {
                     document.querySelectorAll('.shot-btn').forEach(b => { b.classList.remove('active'); b.style.backgroundColor = ""; b.style.boxShadow = ""; b.style.color = ""; b.style.borderColor = ""; }); 
                     btn.classList.add('active'); 
                     btn.innerHTML = "â™»ï¸..."; // Loading Icon
                }

                // 1. Get Raw Values
                const charInput = document.getElementById('charDesc');
                const bgInput = document.getElementById('bgDesc');
                let charVal = charInput.value.trim();
                let bgVal = bgInput.value.trim();

                // 2. AUTO TRANSLATE (Blocking)
                const translatedChar = await translateIfNeeded(charVal);
                const translatedBg = await translateIfNeeded(bgVal);

                // Update Inputs so user sees the English
                if(charVal !== translatedChar) charInput.value = translatedChar;
                if(bgVal !== translatedBg) bgInput.value = translatedBg;

                // 3. Continue Generation with English
                let desc = translatedChar;
                let bgPromptText = translatedBg;
                
                if (btn) btn.innerHTML = originalBtnText; // Restore Button

                // --- Standard Generation Logic ---
                const model = document.getElementById('aiModel').value;
                let subCount = document.getElementById('subCount').value;
                const focusTypeElem = document.querySelector('input[name="focusType"]:checked');
                const focusType = focusTypeElem ? focusTypeElem.value : 'face';
                const shotSizeElem = document.querySelector('input[name="shotSize"]:checked');
                const shotSizeVal = shotSizeElem ? shotSizeElem.value : 'ms';
                const isHorizonLocked = document.getElementById('horizonLock').checked;
                const isWhiteMode = document.getElementById('whiteBg').checked;
                const iw = document.getElementById('iw').value;
                const ar = document.getElementById('ar').value;

                if(desc === "") desc = "Subject"; 
                desc = desc.replace(/,\s*$/, "");
                if(!subCount) subCount = "1";

                let shotKeyword = ""; 
                if (shotSizeVal === 'ecu') shotKeyword = "**Extreme Close-up Shot**";
                else if (shotSizeVal === 'cu') shotKeyword = "**Close-up Shot**";
                else if (shotSizeVal === 'ms') shotKeyword = "**Medium Shot (Waist-up)**";
                else if (shotSizeVal === 'fs') shotKeyword = "**Full Body Shot**";
                else if (shotSizeVal === 'ws') shotKeyword = "**Extreme Wide Shot**";

                let focusDesc = (focusType === 'face') ? "Sharp focus on eyes and face, blurred background" : "Deep depth of field, everything in focus";
                let mainSubject = (subCount === "1") ? `of ${desc}` : `Group photo of ${subCount} people, ${desc}`;

                let bgPrompt = "";
                if (isWhiteMode) bgPrompt = "Solid White Background";
                else if (bgPromptText !== "") bgPrompt = `${bgPromptText}`;

                let angleText = "";
                let gazeText = "";
                
                const isHigh = elevation === 'High';
                const stabilityAnchor = isHigh ? "Strictly vertical orientation, upright posture, the floor is positioned at the bottom of the frame" : "";

                if (angle === 'Front') {
                    angleText = isHigh ? "View looking at the subject's face from a high top-down angle" : "Camera at 6 o'clock position"; 
                    gazeText = (focusType === 'scene') ? "Not looking at camera, natural candid gaze" : "Looking at camera"; 
                } else if (angle === 'Left45') {
                    angleText = isHigh ? "Camera positioned high above focusing on subject's left cheek and shoulder" : "Camera angle from 7:30 o'clock position"; 
                    gazeText = "Looking away from camera, gaze directed to the side";
                } else if (angle === 'Right45') {
                    angleText = isHigh ? "Camera positioned high above focusing on subject's right cheek and shoulder" : "Camera angle from 4:30 o'clock position"; 
                    gazeText = "Looking away from camera, gaze directed to the side";
                } else if (angle === 'FarLeft') {
                    angleText = isHigh ? "High angle side view looking at the subject's left profile and ear" : "Camera angle from 9 o'clock position"; 
                    gazeText = "Not looking at camera, Profile gaze";
                } else if (angle === 'FarRight') {
                    angleText = isHigh ? "High angle side view looking at the subject's right profile and ear" : "Camera angle from 3 o'clock position"; 
                    gazeText = "Not looking at camera, Profile gaze";
                } else if (angle === 'Back') {
                    angleText = isHigh ? "High angle view from directly behind the subject's head, looking down at shoulders" : "Camera angle from 12 o'clock position"; 
                    gazeText = "No face visible, facing away from camera, looking at the background, rear view, back of head";
                }

                let poseConstraint = isHorizonLocked ? "**ğŸ”´ CRITICAL: Group formation aligned relative to horizon.**" : "";
                let headConstraint = (elevation === 'Low' && (angle === 'Left45' || angle === 'Right45')) ? "**ğŸ”´ CRITICAL: Keep chin level, do not tilt head back.**" : "";

                let anglePrefix = "";
                let camPosDesc = ""; 
                if (elevation === 'High') { anglePrefix = "STEEP HIGH ANGLE (Top-down view)"; camPosDesc = "Camera is high above looking down with a fixed top-down perspective"; }
                else if (elevation === 'Eye') { anglePrefix = "EYE-LEVEL SHOT"; camPosDesc = "Camera placed at subject's eye level"; }
                else if (elevation === 'Low') { anglePrefix = "EXTREME LOW ANGLE (Worm's-eye view)"; camPosDesc = "Camera placed on the ground looking up"; }

                let finalPrompt = "";

                if (model === 'mj') {
                    let parts = [`**${anglePrefix}**`, `${shotKeyword} ${mainSubject}`, `${camPosDesc}`, `${angleText}`, gazeText];
                    if (stabilityAnchor) parts.push(stabilityAnchor);
                    if (headConstraint) parts.push(headConstraint);
                    parts.push(focusDesc);
                    if (bgPrompt) parts.push(bgPrompt);
                    if (poseConstraint) parts.push(poseConstraint);
                    parts.push("High fidelity, 8k");
                    finalPrompt = `${parts.join(". ")}. --ar ${ar} --iw ${iw} --style raw`;
                } 
                else if (model === 'nano_pro') {
                    let parts = [anglePrefix, `${shotKeyword} of ${desc}`, camPosDesc, angleText, stabilityAnchor, gazeText, headConstraint, bgPrompt ? `Background is ${bgPrompt}` : "", poseConstraint, "Hyper-realistic, 8k resolution, cinematic lighting, highly detailed"];
                    finalPrompt = `${parts.filter(p => p !== "").join(". ")} --ar ${ar}`;
                }
                else if (model === 'natural') {
                    let parts = [anglePrefix, `Shot: ${shotKeyword}`, `Subject: ${desc}`, `Angle: ${angleText}`, stabilityAnchor, `Gaze: ${gazeText}`, bgPrompt ? `Background: ${bgPrompt}` : "", "Photorealistic"];
                    finalPrompt = `${parts.filter(p => p !== "").join(". ")} --ar ${ar}`;
                }
                else {
                    let parts = ["(masterpiece)", anglePrefix.toLowerCase(), shotKeyword, desc, angleText, stabilityAnchor, gazeText, bgPrompt, "8k resolution"];
                    finalPrompt = `${parts.filter(p => p !== "").join(", ")} --ar ${ar}`;
                }

                const output = document.getElementById('resultPrompt');
                output.value = finalPrompt;
                manualCopy();
            } catch (e) {
                alert("âš ï¸ Error: " + e.message);
            }
        }

        function manualCopy() {
            const output = document.getElementById('resultPrompt');
            if(output.value === "") return;
            output.select();
            document.execCommand('copy');
            const msg = document.getElementById('copyMsg');
            msg.style.opacity = 1;
            setTimeout(() => { msg.style.opacity = 0; }, 2000);
        }
    </script>
</body>
</html>
